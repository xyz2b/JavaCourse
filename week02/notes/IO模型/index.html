<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<title>IO</title>
	</head>
<body>
<h2>IO</h2>

<h3>同步异步阻塞非阻塞</h3>

<p>同步异步是对于通信</p>

<p>阻塞不阻塞是对于进程</p>

<p>比如发送一个请求 然后必须等这个请求响应之后再发另一个请求这就是同步</p>

<p>比如发送一个请求之后，不用等这个请求是否响应，继续发下一个请求这就是异步</p>

<p>比如发送一个请求之后线程就停在这等着这个请求返回这就是线程阻塞了</p>

<p>比如发送一个请求之后该线程不等着响应就去做别的事情了，在别做别的事情间隔期间查询这个请求是否响应或者这个请求得到响应之后通知该线程做进一步处理这就是线程非阻塞</p>

<h3>IO模型</h3>

<p>1.同步阻塞IO模型</p>

<p>用户进程向内核发起recvform系统调用，内核此时没有准备好数据不会返回，进程阻塞挂起等待，此时进程不能接受其他套接字请求</p>

<p>内核准备好数据，唤醒挂起的进程处理数据</p>

<p>进程将数据从内核空间复制到用户空间</p>

<figure><img src="%E5%BA%94%E7%94%A8%E9%80%B8%E7%A8%8B.png"/></figure>

<p>全程阻塞</p>

<p>及时返回数据，无延迟</p>

<p>内核开发简单</p>

<p>用户进程一直阻塞不能做别的事情，型男受到影响</p>

<p>2.同步非阻塞IO模型</p>

<p>用户进程向内核发起recvform系统调用，内核此时没有准备好数据立即返回，不会阻塞进程，进程可以接受其他套接字请求。进程轮询发起recform系统调用查看内核是否准备好数据</p>

<p>在轮询中某一次查询发现内核准备好了数据，进程将数据从内核空间复制到用户空间</p>

<figure><img src="rocvfree.png"/></figure>

<p>只有第二步是阻塞的</p>

<p>用户进程在数据没有准备好时可以做其他事 </p>

<p>但需要用户进程不断轮询，占用用户进程大量cpu时间</p>

<p>同时会导致响应延迟，因为轮询是间隔一段时间才去轮询，如果数据正好在两次轮询中准备好</p>

<p>3.IO多路复用模型</p>

<p>用户进程发起select系统调用，内核此时没有准备好数据，由内核select负责轮询监听数据有没有准备好，用户进程阻塞于select调用，但select可以等待多个socket，同时监听多个IO端口。</p>

<p>当select监听的多个socket有一个数据准备好了，即可读，立即返回给用户进程socket可读状态，用户进程再发起recvform系统调用将数据复制到用户空间</p>

<figure><img src="solect.png"/></figure>

<p>第一步可能阻塞可能不阻塞</p>

<p>第二步都会阻塞</p>

<p>同步阻塞</p>

<p>与非阻塞IO的区别是无需用户进程轮询socket状态，由内核负责完成，同时内核可以监听多个socket状态</p>

<p>4.信号驱动式IO模型</p>

<p>用户进程发起sigaction系统调用安装SIGIO信号处理函数，内核立即返回，用户进程不会阻塞可以做其他事情</p>

<p>当内核将数据准备好，进程会收到一个SIGIO信号，然后调用进程之前安装好的信号处理函数，在信号处理函数中调用recvform系统调用将数据复制到用户空间</p>

<figure><img src="reevfrom.png"/></figure>

<p>只有第二步是阻塞的</p>

<p>5.异步非阻塞IO</p>

<p>用户进程发起系统调用aio<em>read，数据没有准备好，内核立即返回
</em></p>

<p>数据准备好之后，内核负责将数据复制到用户空间，然后再在aio<em>read指定的信号中，通知用户进程处理数据
</em></p>

<figure><img src="alo.read.png"/></figure>

<p>全程无阻塞</p>

<p>6.五种IO模型对比</p>

<figure><img src="%E7%88%B1%E8%B5%B7.png"/></figure>

</body>
</html>

